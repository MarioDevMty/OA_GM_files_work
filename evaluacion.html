<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Evaluaci√≥n - Gr√°ficas de Funciones</title>
    
    <!-- CSS Organizado -->
    <link rel="stylesheet" href="css/base.css">
    <link rel="stylesheet" href="css/layout.css">
    <link rel="stylesheet" href="css/components/navigation.css">
    <link rel="stylesheet" href="css/components/buttons.css">
    <link rel="stylesheet" href="css/components/cards.css">
    <link rel="stylesheet" href="css/components/forms.css">
    <link rel="stylesheet" href="css/pages/evaluacion.css">
    <link rel="stylesheet" href="css/pages/grafico.css">
</head>

<body>
    <nav class="nav-dots">
        <ul>
            <li><a href="index.html">1</a></li>
            <li><a href="teoria.html">2</a></li>
            <li><a href="grafico.html">3</a></li>
            <li><a href="aplicacion.html">4</a></li>
            <li><a href="evaluacion.html" class="active">5</a></li>
        </ul>
    </nav>

    <main class="main-content">
        <!-- Encabezado con Logos -->
        <div class="logo-container">
            <img src="assets/Uanl-color-negro.png" alt="UANL" class="logo left-logo">
            <img src="assets/Logo-Excelencia-Negro.png" alt="Excelencia" class="logo right-logo">
        </div>

        <div class="content-page-evaluation">
            <h2>Evaluaci√≥n de Gr√°ficas de Funciones</h2>
            <p>Selecciona la opci√≥n que mejor describa la gr√°fica de cada funci√≥n. ¬°Al finalizar, podr√°s ver tus resultados!</p>

            <form id="evaluationForm" class="evaluation-form">
                <!-- Pregunta 1 -->
                <div class="evaluation-question" id="question1">
                    <h3>Pregunta 1: ¬øQu√© tipo de funci√≥n es y = x + 3?</h3>
                    <div class="image-container">
                        <img src="assets/x+3.png" alt="Gr√°fica de una l√≠nea recta">
                    </div>
                    <div class="evaluation-options">
                        <label>
                            <input type="radio" name="q1" value="A">
                            <span>A) Lineal</span>
                        </label>
                        <label>
                            <input type="radio" name="q1" value="B">
                            <span>B) Cuadr√°tica</span>
                        </label>
                        <label>
                            <input type="radio" name="q1" value="C">
                            <span>C) C√∫bica</span>
                        </label>
                    </div>
                    <div class="feedback" id="feedback1"></div>
                </div>

                <!-- Pregunta 2 -->
                <div class="evaluation-question" id="question2">
                    <h3>Pregunta 2: ¬øQu√© funci√≥n corresponde a esta gr√°fica?</h3>
                    <div class="image-container">
                        <img src="assets/x2-1.png" alt="Gr√°fica de una par√°bola">
                    </div>
                    <div class="evaluation-options">
                        <label>
                            <input type="radio" name="q2" value="A">
                            <span>A) y = x + 2</span>
                        </label>
                        <label>
                            <input type="radio" name="q2" value="B">
                            <span>B) y = x¬≤ - 1</span>
                        </label>
                        <label>
                            <input type="radio" name="q2" value="C">
                            <span>C) y = 2x</span>
                        </label>
                    </div>
                    <div class="feedback" id="feedback2"></div>
                </div>
                
                <!-- Pregunta 3 -->
                <div class="evaluation-question" id="question3">
                    <h3>Pregunta 3: La gr√°fica de y = x¬≥ + 1 tiene una forma de "S". ¬øC√≥mo se le conoce a este tipo de funci√≥n?</h3>
                    <div class="image-container">
                        <img src="assets/x3-1.png" alt="Gr√°fica de una funci√≥n c√∫bica">
                    </div>
                    <div class="evaluation-options">
                        <label>
                            <input type="radio" name="q3" value="A">
                            <span>A) Racional</span>
                        </label>
                        <label>
                            <input type="radio" name="q3" value="B">
                            <span>B) C√∫bica</span>
                        </label>
                        <label>
                            <input type="radio" name="q3" value="C">
                            <span>C) Exponencial</span>
                        </label>
                    </div>
                    <div class="feedback" id="feedback3"></div>
                </div>

                <!-- Pregunta 4 -->
                <div class="evaluation-question" id="question4">
                    <h3>Pregunta 4: ¬øQu√© funci√≥n representa esta gr√°fica con as√≠ntota vertical?</h3>
                    <div class="image-container">
                        <img src="assets/1sobrex.png" alt="Gr√°fica de funci√≥n racional">
                    </div>
                    <div class="evaluation-options">
                        <label>
                            <input type="radio" name="q4" value="A">
                            <span>A) y = 1/x</span>
                        </label>
                        <label>
                            <input type="radio" name="q4" value="B">
                            <span>B) y = ‚àöx</span>
                        </label>
                        <label>
                            <input type="radio" name="q4" value="C">
                            <span>C) y = x¬≤</span>
                        </label>
                    </div>
                    <div class="feedback" id="feedback4"></div>
                </div>

                <!-- Pregunta 5 -->
                <div class="evaluation-question" id="question5">
                    <h3>Pregunta 5: ¬øQu√© tipo de funci√≥n es y = ‚àöx?</h3>
                    <div class="image-container">
                        <img src="assets/sqrtx.png" alt="Gr√°fica de funci√≥n ra√≠z cuadrada">
                    </div>
                    <div class="evaluation-options">
                        <label>
                            <input type="radio" name="q5" value="A">
                            <span>A) Ra√≠z cuadrada</span>
                        </label>
                        <label>
                            <input type="radio" name="q5" value="B">
                            <span>B) Lineal</span>
                        </label>
                        <label>
                            <input type="radio" name="q5" value="C">
                            <span>C) Cuadr√°tica</span>
                        </label>
                    </div>
                    <div class="feedback" id="feedback5"></div>
                </div>

                <!-- Pregunta 6 -->
                <div class="evaluation-question" id="question6">
                    <h3>Pregunta 6: ¬øQu√© funci√≥n tiene esta gr√°fica con pendiente negativa?</h3>
                    <div class="image-container">
                        <img src="assets/-x+2.png" alt="Gr√°fica de l√≠nea con pendiente negativa">
                    </div>
                    <div class="evaluation-options">
                        <label>
                            <input type="radio" name="q6" value="A">
                            <span>A) y = -x + 2</span>
                        </label>
                        <label>
                            <input type="radio" name="q6" value="B">
                            <span>B) y = x + 2</span>
                        </label>
                        <label>
                            <input type="radio" name="q6" value="C">
                            <span>C) y = 2x</span>
                        </label>
                    </div>
                    <div class="feedback" id="feedback6"></div>
                </div>

                <!-- Pregunta 7 -->
                <div class="evaluation-question" id="question7">
                    <h3>Pregunta 7: ¬øQu√© caracter√≠stica tiene la gr√°fica de y = |x|?</h3>
                    <div class="image-container">
                        <img src="assets/valorabsoluto.png" alt="Gr√°fica de valor absoluto">
                    </div>
                    <div class="evaluation-options">
                        <label>
                            <input type="radio" name="q7" value="A">
                            <span>A) Forma de "V"</span>
                        </label>
                        <label>
                            <input type="radio" name="q7" value="B">
                            <span>B) Forma de par√°bola</span>
                        </label>
                        <label>
                            <input type="radio" name="q7" value="C">
                            <span>C) L√≠nea recta</span>
                        </label>
                    </div>
                    <div class="feedback" id="feedback7"></div>
                </div>

                <!-- Pregunta 8 -->
                <div class="evaluation-question" id="question8">
                    <h3>Pregunta 8: ¬øQu√© funci√≥n representa esta par√°bola que abre hacia abajo?</h3>
                    <div class="image-container">
                        <img src="assets/-x2+4.png" alt="Gr√°fica de par√°bola hacia abajo">
                    </div>
                    <div class="evaluation-options">
                        <label>
                            <input type="radio" name="q8" value="A">
                            <span>A) y = -x¬≤ + 4</span>
                        </label>
                        <label>
                            <input type="radio" name="q8" value="B">
                            <span>B) y = x¬≤ + 4</span>
                        </label>
                        <label>
                            <input type="radio" name="q8" value="C">
                            <span>C) y = x¬≤ - 4</span>
                        </label>
                    </div>
                    <div class="feedback" id="feedback8"></div>
                </div>

                <!-- Pregunta 9 -->
                <div class="evaluation-question" id="question9">
                    <h3>Pregunta 9: ¬øQu√© tipo de funci√≥n es y = 2À£?</h3>
                    <div class="image-container">
                        <img src="assets/2alax.png" alt="Gr√°fica de funci√≥n exponencial">
                    </div>
                    <div class="evaluation-options">
                        <label>
                            <input type="radio" name="q9" value="A">
                            <span>A) Exponencial</span>
                        </label>
                        <label>
                            <input type="radio" name="q9" value="B">
                            <span>B) Logar√≠tmica</span>
                        </label>
                        <label>
                            <input type="radio" name="q9" value="C">
                            <span>C) Lineal</span>
                        </label>
                    </div>
                    <div class="feedback" id="feedback9"></div>
                </div>

                <!-- Pregunta 10 -->
                <div class="evaluation-question" id="question10">
                    <h3>Pregunta 10: ¬øQu√© funci√≥n tiene esta gr√°fica con dos ramas hiperb√≥licas?</h3>
                    <div class="image-container">
                        <img src="assets/racional.png" alt="Gr√°fica de funci√≥n racional">
                    </div>
                    <div class="evaluation-options">
                        <label>
                            <input type="radio" name="q10" value="A">
                            <span>A) y = (x-1)/(x+2)</span>
                        </label>
                        <label>
                            <input type="radio" name="q10" value="B">
                            <span>B) y = x¬≤</span>
                        </label>
                        <label>
                            <input type="radio" name="q10" value="C">
                            <span>C) y = ‚àöx</span>
                        </label>
                    </div>
                    <div class="feedback" id="feedback10"></div>
                </div>

                <!-- Botones de Acci√≥n -->
                <div class="submit-container">
                    <button type="submit" class="action-btn">Revisar mis respuestas</button>
                    <button type="button" class="action-btn secondary-btn" id="reset-btn">Reiniciar Evaluaci√≥n</button>
                </div>
            </form>
            
            <!-- Resultados -->
            <div id="results" class="results-container"></div>
            
            <!-- Navegaci√≥n -->
            <div class="button-group" style="margin-top: 2rem;">
                <a href="aplicacion.html" class="action-btn secondary-btn">Volver a Pr√°ctica</a>
                <a href="index.html" class="action-btn secondary-btn">Ir al Inicio</a>
            </div>
        </div>
    </main>

    <!-- JavaScript -->
    <script src="js/core/navigation.js"></script>
    <script>
        // ===== L√ìGICA DE EVALUACI√ìN =====
        const EvaluacionManager = {
            respuestasUsuario: {},
            isSubmitted: false,

            // Respuestas correctas para las 10 preguntas
            respuestasCorrectas: {
                q1: 'A', // y = x + 3 es lineal
                q2: 'B', // La par√°bola es y = x¬≤ - 1
                q3: 'B', // Gr√°fica en "S" es c√∫bica
                q4: 'A', // As√≠ntota vertical es y = 1/x
                q5: 'A', // y = ‚àöx es ra√≠z cuadrada
                q6: 'A', // Pendiente negativa es y = -x + 2
                q7: 'A', // y = |x| tiene forma de "V"
                q8: 'A', // Par√°bola hacia abajo es y = -x¬≤ + 4
                q9: 'A', // y = 2À£ es exponencial
                q10: 'A' // Dos ramas hiperb√≥licas es funci√≥n racional
            },

            /**
             * Inicializar evaluaci√≥n
             */
            init: function() {
                console.log('Inicializando evaluaci√≥n...');
                this.loadProgress();
                this.setupEventListeners();
                this.updateProgressUI();
            },

            /**
             * Configurar event listeners
             */
            setupEventListeners: function() {
                const form = document.getElementById('evaluationForm');
                if (form) {
                    form.addEventListener('submit', (e) => this.handleSubmit(e));
                }

                // Cambios en respuestas para feedback inmediato
                document.querySelectorAll('input[type="radio"]').forEach(radio => {
                    radio.addEventListener('change', (e) => this.onAnswerChange(e));
                });

                // Bot√≥n reiniciar
                const resetBtn = document.getElementById('reset-btn');
                if (resetBtn) {
                    resetBtn.addEventListener('click', () => this.resetForm());
                }
            },

            /**
             * Manejar env√≠o del formulario
             */
            handleSubmit: function(event) {
                event.preventDefault();
                
                if (this.isSubmitted) {
                    this.mostrarResultados();
                    return;
                }

                this.evaluarRespuestas();
                this.mostrarResultados();
                this.isSubmitted = true;
                this.saveProgress();
            },

            /**
             * Manejar cambio de respuesta
             */
            onAnswerChange: function(event) {
                const radio = event.target;
                const questionName = radio.name;
                
                // Guardar respuesta
                this.respuestasUsuario[questionName] = radio.value;
                this.saveProgress();
            },

            /**
             * Evaluar todas las respuestas
             */
            evaluarRespuestas: function() {
                let score = 0;
                const totalQuestions = Object.keys(this.respuestasCorrectas).length;

                // Evaluar cada pregunta
                for (const [questionId, correctAnswer] of Object.entries(this.respuestasCorrectas)) {
                    const userAnswer = this.respuestasUsuario[questionId];
                    const questionNumber = questionId.replace('q', '');
                    
                    this.mostrarFeedback(questionNumber, userAnswer, correctAnswer);
                    
                    if (userAnswer === correctAnswer) {
                        score++;
                    }
                }

                this.calcularResultadoFinal(score, totalQuestions);
            },

            /**
             * Mostrar feedback por pregunta
             */
            mostrarFeedback: function(questionNumber, userAnswer, correctAnswer) {
                const feedbackEl = document.getElementById(`feedback${questionNumber}`);
                if (!feedbackEl) return;

                // Limpiar feedback anterior
                feedbackEl.className = 'feedback';
                feedbackEl.innerHTML = '';

                if (!userAnswer) {
                    feedbackEl.textContent = 'No respondida ‚ö†Ô∏è';
                    feedbackEl.classList.add('warning');
                    return;
                }

                if (userAnswer === correctAnswer) {
                    feedbackEl.innerHTML = '‚úÖ <strong>Correcto!</strong>';
                    feedbackEl.classList.add('correct');
                } else {
                    feedbackEl.innerHTML = `‚ùå <strong>Incorrecto.</strong> La respuesta correcta es ${this.getAnswerText(correctAnswer, questionNumber)}`;
                    feedbackEl.classList.add('incorrect');
                }
            },

            /**
             * Obtener texto de la respuesta
             */
            getAnswerText: function(answerKey, questionNumber) {
                const answerTexts = {
                    'A': this.getAnswerDescription('A', questionNumber),
                    'B': this.getAnswerDescription('B', questionNumber),
                    'C': this.getAnswerDescription('C', questionNumber)
                };
                return answerTexts[answerKey] || answerKey;
            },

            /**
             * Obtener descripci√≥n de la respuesta
             */
            getAnswerDescription: function(answer, questionNumber) {
                const descriptions = {
                    '1': { 'A': 'Lineal', 'B': 'Cuadr√°tica', 'C': 'C√∫bica' },
                    '2': { 'A': 'y = x + 2', 'B': 'y = x¬≤ - 1', 'C': 'y = 2x' },
                    '3': { 'A': 'Racional', 'B': 'C√∫bica', 'C': 'Exponencial' },
                    '4': { 'A': 'y = 1/x', 'B': 'y = ‚àöx', 'C': 'y = x¬≤' },
                    '5': { 'A': 'Ra√≠z cuadrada', 'B': 'Lineal', 'C': 'Cuadr√°tica' },
                    '6': { 'A': 'y = -x + 2', 'B': 'y = x + 2', 'C': 'y = 2x' },
                    '7': { 'A': 'Forma de "V"', 'B': 'Forma de par√°bola', 'C': 'L√≠nea recta' },
                    '8': { 'A': 'y = -x¬≤ + 4', 'B': 'y = x¬≤ + 4', 'C': 'y = x¬≤ - 4' },
                    '9': { 'A': 'Exponencial', 'B': 'Logar√≠tmica', 'C': 'Lineal' },
                    '10': { 'A': 'y = (x-1)/(x+2)', 'B': 'y = x¬≤', 'C': 'y = ‚àöx' }
                };
                return descriptions[questionNumber][answer] || answer;
            },

            /**
             * Calcular resultado final
             */
            calcularResultadoFinal: function(score, total) {
                const resultsDiv = document.getElementById('results');
                if (!resultsDiv) return;

                const percentage = (score / total) * 100;
                
                let message, emoji, colorClass;
                
                if (percentage >= 90) {
                    message = '¬°Excelente! Dominas perfectamente las gr√°ficas de funciones üéâ';
                    emoji = 'üèÜ';
                    colorClass = 'excellent';
                } else if (percentage >= 70) {
                    message = '¬°Buen trabajo! Tienes un buen entendimiento de las gr√°ficas üëç';
                    emoji = '‚≠ê';
                    colorClass = 'good';
                } else if (percentage >= 50) {
                    message = '¬°Bien hecho! Sigue practicando para mejorar üí™';
                    emoji = 'üìö';
                    colorClass = 'average';
                } else {
                    message = 'Sigue estudiando y practicando. ¬°T√∫ puedes! üìñ';
                    emoji = 'üéØ';
                    colorClass = 'needs-improvement';
                }

                resultsDiv.innerHTML = `
                    <div class="evaluation-results ${colorClass}">
                        <h3>Resultado de la Evaluaci√≥n</h3>
                        <div class="evaluation-score">${score}/${total}</div>
                        <div class="evaluation-percentage">${percentage.toFixed(0)}%</div>
                        <p>${message} ${emoji}</p>
                        <div class="evaluation-progress">
                            <div class="evaluation-progress-bar" style="width: ${percentage}%"></div>
                        </div>
                        <p class="evaluation-feedback">${this.getDetailedFeedback(percentage)}</p>
                    </div>
                `;
                
                resultsDiv.style.display = 'block';
                
                // Animaci√≥n
                setTimeout(() => {
                    resultsDiv.classList.add('evaluation-correct');
                }, 100);
            },

            /**
             * Obtener feedback detallado
             */
            getDetailedFeedback: function(percentage) {
                if (percentage >= 90) {
                    return 'Has demostrado un excelente entendimiento de los diferentes tipos de funciones y sus gr√°ficas.';
                } else if (percentage >= 70) {
                    return 'Tienes un buen conocimiento base. Revisa los conceptos de funciones racionales y exponenciales.';
                } else if (percentage >= 50) {
                    return 'Recomendamos repasar las caracter√≠sticas de las funciones cuadr√°ticas, c√∫bicas y racionales.';
                } else {
                    return 'Te sugerimos revisar la teor√≠a sobre los diferentes tipos de funciones y practicar m√°s con los ejemplos.';
                }
            },

            /**
             * Mostrar resultados
             */
            mostrarResultados: function() {
                const resultsDiv = document.getElementById('results');
                if (resultsDiv && resultsDiv.style.display !== 'block') {
                    resultsDiv.style.display = 'block';
                }
            },

            /**
             * Reiniciar formulario
             */
            resetForm: function() {
                const form = document.getElementById('evaluationForm');
                if (form) {
                    form.reset();
                }

                // Limpiar feedback
                document.querySelectorAll('.feedback').forEach(el => {
                    el.innerHTML = '';
                    el.className = 'feedback';
                });

                // Ocultar resultados
                const resultsDiv = document.getElementById('results');
                if (resultsDiv) {
                    resultsDiv.style.display = 'none';
                    resultsDiv.innerHTML = '';
                }

                // Resetear estado
                this.respuestasUsuario = {};
                this.isSubmitted = false;
                
                // Limpiar progreso
                localStorage.removeItem('evaluacion-progress');
            },

            /**
             * Cargar progreso
             */
            loadProgress: function() {
                const saved = localStorage.getItem('evaluacion-progress');
                if (saved) {
                    const progress = JSON.parse(saved);
                    this.respuestasUsuario = progress.respuestasUsuario || {};
                    this.isSubmitted = progress.isSubmitted || false;
                    
                    // Restaurar respuestas
                    this.restoreAnswers();
                }
            },

            /**
             * Guardar progreso
             */
            saveProgress: function() {
                const progress = {
                    respuestasUsuario: this.respuestasUsuario,
                    isSubmitted: this.isSubmitted,
                    timestamp: new Date().toISOString()
                };
                
                localStorage.setItem('evaluacion-progress', JSON.stringify(progress));
            },

            /**
             * Restaurar respuestas desde progreso
             */
            restoreAnswers: function() {
                for (const [questionName, answer] of Object.entries(this.respuestasUsuario)) {
                    const radio = document.querySelector(`input[name="${questionName}"][value="${answer}"]`);
                    if (radio) {
                        radio.checked = true;
                    }
                }
            },

            /**
             * Actualizar UI de progreso
             */
            updateProgressUI: function() {
                const answeredCount = Object.keys(this.respuestasUsuario).length;
                const totalQuestions = Object.keys(this.respuestasCorrectas).length;
                
                // Puedes mostrar un indicador de progreso si quieres
                console.log(`Progreso: ${answeredCount}/${totalQuestions} preguntas respondidas`);
            }
        };

        // Inicializar cuando el DOM est√© listo
        document.addEventListener('DOMContentLoaded', function() {
            // Inicializar navegaci√≥n
            NavigationManager.init();
            
            // Inicializar evaluaci√≥n
            EvaluacionManager.init();
        });
    </script>
</body>
</html>