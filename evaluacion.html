<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Evaluación - Gráficas de Funciones</title>
    
    <!-- CSS Organizado -->
    <link rel="stylesheet" href="css/base.css">
    <link rel="stylesheet" href="css/layout.css">
    <link rel="stylesheet" href="css/components/navigation.css">
    <link rel="stylesheet" href="css/components/buttons.css">
    <link rel="stylesheet" href="css/components/cards.css">
    <link rel="stylesheet" href="css/components/forms.css">
    <link rel="stylesheet" href="css/pages/evaluacion.css">
    <link rel="stylesheet" href="css/pages/grafico.css">
</head>

<body>
    <nav class="nav-dots">
        <ul>
            <li><a href="index.html">1</a></li>
            <li><a href="teoria.html">2</a></li>
            <li><a href="grafico.html">3</a></li>
            <li><a href="aplicacion.html">4</a></li>
            <li><a href="evaluacion.html" class="active">5</a></li>
        </ul>
    </nav>

    <main class="main-content">
        <!-- Encabezado con Logos -->
        <div class="logo-container">
            <img src="assets/Uanl-color-negro.png" alt="UANL" class="logo left-logo">
            <img src="assets/Logo-Excelencia-Negro.png" alt="Excelencia" class="logo right-logo">
        </div>

        <div class="content-page-evaluation">
            <h2>Evaluación de Gráficas de Funciones</h2>
            <p>Selecciona la opción que mejor describa la gráfica de cada función. ¡Al finalizar, podrás ver tus resultados!</p>

            <form id="evaluationForm" class="evaluation-form">
                <!-- Pregunta 1 -->
                <div class="evaluation-question" id="question1">
                    <h3>Pregunta 1: ¿Qué tipo de función es y = x + 3?</h3>
                    <div class="image-container">
                        <img src="assets/x+3.png" alt="Gráfica de una línea recta">
                    </div>
                    <div class="evaluation-options">
                        <label>
                            <input type="radio" name="q1" value="A">
                            <span>A) Lineal</span>
                        </label>
                        <label>
                            <input type="radio" name="q1" value="B">
                            <span>B) Cuadrática</span>
                        </label>
                        <label>
                            <input type="radio" name="q1" value="C">
                            <span>C) Cúbica</span>
                        </label>
                    </div>
                    <div class="feedback" id="feedback1"></div>
                </div>

                <!-- Pregunta 2 -->
                <div class="evaluation-question" id="question2">
                    <h3>Pregunta 2: ¿Qué función corresponde a esta gráfica?</h3>
                    <div class="image-container">
                        <img src="assets/x2-1.png" alt="Gráfica de una parábola">
                    </div>
                    <div class="evaluation-options">
                        <label>
                            <input type="radio" name="q2" value="A">
                            <span>A) y = x + 2</span>
                        </label>
                        <label>
                            <input type="radio" name="q2" value="B">
                            <span>B) y = x² - 1</span>
                        </label>
                        <label>
                            <input type="radio" name="q2" value="C">
                            <span>C) y = 2x</span>
                        </label>
                    </div>
                    <div class="feedback" id="feedback2"></div>
                </div>
                
                <!-- Pregunta 3 -->
                <div class="evaluation-question" id="question3">
                    <h3>Pregunta 3: La gráfica de y = x³ + 1 tiene una forma de "S". ¿Cómo se le conoce a este tipo de función?</h3>
                    <div class="image-container">
                        <img src="assets/x3-1.png" alt="Gráfica de una función cúbica">
                    </div>
                    <div class="evaluation-options">
                        <label>
                            <input type="radio" name="q3" value="A">
                            <span>A) Racional</span>
                        </label>
                        <label>
                            <input type="radio" name="q3" value="B">
                            <span>B) Cúbica</span>
                        </label>
                        <label>
                            <input type="radio" name="q3" value="C">
                            <span>C) Exponencial</span>
                        </label>
                    </div>
                    <div class="feedback" id="feedback3"></div>
                </div>

                <!-- Pregunta 4 -->
                <div class="evaluation-question" id="question4">
                    <h3>Pregunta 4: ¿Qué función representa esta gráfica con asíntota vertical?</h3>
                    <div class="image-container">
                        <img src="assets/1sobrex.png" alt="Gráfica de función racional">
                    </div>
                    <div class="evaluation-options">
                        <label>
                            <input type="radio" name="q4" value="A">
                            <span>A) y = 1/x</span>
                        </label>
                        <label>
                            <input type="radio" name="q4" value="B">
                            <span>B) y = √x</span>
                        </label>
                        <label>
                            <input type="radio" name="q4" value="C">
                            <span>C) y = x²</span>
                        </label>
                    </div>
                    <div class="feedback" id="feedback4"></div>
                </div>

                <!-- Pregunta 5 -->
                <div class="evaluation-question" id="question5">
                    <h3>Pregunta 5: ¿Qué tipo de función es y = √x?</h3>
                    <div class="image-container">
                        <img src="assets/sqrtx.png" alt="Gráfica de función raíz cuadrada">
                    </div>
                    <div class="evaluation-options">
                        <label>
                            <input type="radio" name="q5" value="A">
                            <span>A) Raíz cuadrada</span>
                        </label>
                        <label>
                            <input type="radio" name="q5" value="B">
                            <span>B) Lineal</span>
                        </label>
                        <label>
                            <input type="radio" name="q5" value="C">
                            <span>C) Cuadrática</span>
                        </label>
                    </div>
                    <div class="feedback" id="feedback5"></div>
                </div>

                <!-- Pregunta 6 -->
                <div class="evaluation-question" id="question6">
                    <h3>Pregunta 6: ¿Qué función tiene esta gráfica con pendiente negativa?</h3>
                    <div class="image-container">
                        <img src="assets/-x+2.png" alt="Gráfica de línea con pendiente negativa">
                    </div>
                    <div class="evaluation-options">
                        <label>
                            <input type="radio" name="q6" value="A">
                            <span>A) y = -x + 2</span>
                        </label>
                        <label>
                            <input type="radio" name="q6" value="B">
                            <span>B) y = x + 2</span>
                        </label>
                        <label>
                            <input type="radio" name="q6" value="C">
                            <span>C) y = 2x</span>
                        </label>
                    </div>
                    <div class="feedback" id="feedback6"></div>
                </div>

                <!-- Pregunta 7 -->
                <div class="evaluation-question" id="question7">
                    <h3>Pregunta 7: ¿Qué característica tiene la gráfica de y = |x|?</h3>
                    <div class="image-container">
                        <img src="assets/valorabsoluto.png" alt="Gráfica de valor absoluto">
                    </div>
                    <div class="evaluation-options">
                        <label>
                            <input type="radio" name="q7" value="A">
                            <span>A) Forma de "V"</span>
                        </label>
                        <label>
                            <input type="radio" name="q7" value="B">
                            <span>B) Forma de parábola</span>
                        </label>
                        <label>
                            <input type="radio" name="q7" value="C">
                            <span>C) Línea recta</span>
                        </label>
                    </div>
                    <div class="feedback" id="feedback7"></div>
                </div>

                <!-- Pregunta 8 -->
                <div class="evaluation-question" id="question8">
                    <h3>Pregunta 8: ¿Qué función representa esta parábola que abre hacia abajo?</h3>
                    <div class="image-container">
                        <img src="assets/-x2+4.png" alt="Gráfica de parábola hacia abajo">
                    </div>
                    <div class="evaluation-options">
                        <label>
                            <input type="radio" name="q8" value="A">
                            <span>A) y = -x² + 4</span>
                        </label>
                        <label>
                            <input type="radio" name="q8" value="B">
                            <span>B) y = x² + 4</span>
                        </label>
                        <label>
                            <input type="radio" name="q8" value="C">
                            <span>C) y = x² - 4</span>
                        </label>
                    </div>
                    <div class="feedback" id="feedback8"></div>
                </div>

                <!-- Pregunta 9 -->
                <div class="evaluation-question" id="question9">
                    <h3>Pregunta 9: ¿Qué tipo de función es y = 2ˣ?</h3>
                    <div class="image-container">
                        <img src="assets/2alax.png" alt="Gráfica de función exponencial">
                    </div>
                    <div class="evaluation-options">
                        <label>
                            <input type="radio" name="q9" value="A">
                            <span>A) Exponencial</span>
                        </label>
                        <label>
                            <input type="radio" name="q9" value="B">
                            <span>B) Logarítmica</span>
                        </label>
                        <label>
                            <input type="radio" name="q9" value="C">
                            <span>C) Lineal</span>
                        </label>
                    </div>
                    <div class="feedback" id="feedback9"></div>
                </div>

                <!-- Pregunta 10 -->
                <div class="evaluation-question" id="question10">
                    <h3>Pregunta 10: ¿Qué función tiene esta gráfica con dos ramas hiperbólicas?</h3>
                    <div class="image-container">
                        <img src="assets/racional.png" alt="Gráfica de función racional">
                    </div>
                    <div class="evaluation-options">
                        <label>
                            <input type="radio" name="q10" value="A">
                            <span>A) y = (x-1)/(x+2)</span>
                        </label>
                        <label>
                            <input type="radio" name="q10" value="B">
                            <span>B) y = x²</span>
                        </label>
                        <label>
                            <input type="radio" name="q10" value="C">
                            <span>C) y = √x</span>
                        </label>
                    </div>
                    <div class="feedback" id="feedback10"></div>
                </div>

                <!-- Botones de Acción -->
                <div class="submit-container">
                    <button type="submit" class="action-btn">Revisar mis respuestas</button>
                    <button type="button" class="action-btn secondary-btn" id="reset-btn">Reiniciar Evaluación</button>
                </div>
            </form>
            
            <!-- Resultados -->
            <div id="results" class="results-container"></div>
            
            <!-- Navegación -->
            <div class="button-group" style="margin-top: 2rem;">
                <a href="aplicacion.html" class="action-btn secondary-btn">Volver a Práctica</a>
                <a href="index.html" class="action-btn secondary-btn">Ir al Inicio</a>
            </div>
        </div>
    </main>

    <!-- JavaScript -->
    <script src="js/core/navigation.js"></script>
    <script>
        // ===== LÓGICA DE EVALUACIÓN =====
        const EvaluacionManager = {
            respuestasUsuario: {},
            isSubmitted: false,

            // Respuestas correctas para las 10 preguntas
            respuestasCorrectas: {
                q1: 'A', // y = x + 3 es lineal
                q2: 'B', // La parábola es y = x² - 1
                q3: 'B', // Gráfica en "S" es cúbica
                q4: 'A', // Asíntota vertical es y = 1/x
                q5: 'A', // y = √x es raíz cuadrada
                q6: 'A', // Pendiente negativa es y = -x + 2
                q7: 'A', // y = |x| tiene forma de "V"
                q8: 'A', // Parábola hacia abajo es y = -x² + 4
                q9: 'A', // y = 2ˣ es exponencial
                q10: 'A' // Dos ramas hiperbólicas es función racional
            },

            /**
             * Inicializar evaluación
             */
            init: function() {
                console.log('Inicializando evaluación...');
                this.loadProgress();
                this.setupEventListeners();
                this.updateProgressUI();
            },

            /**
             * Configurar event listeners
             */
            setupEventListeners: function() {
                const form = document.getElementById('evaluationForm');
                if (form) {
                    form.addEventListener('submit', (e) => this.handleSubmit(e));
                }

                // Cambios en respuestas para feedback inmediato
                document.querySelectorAll('input[type="radio"]').forEach(radio => {
                    radio.addEventListener('change', (e) => this.onAnswerChange(e));
                });

                // Botón reiniciar
                const resetBtn = document.getElementById('reset-btn');
                if (resetBtn) {
                    resetBtn.addEventListener('click', () => this.resetForm());
                }
            },

            /**
             * Manejar envío del formulario
             */
            handleSubmit: function(event) {
                event.preventDefault();
                
                if (this.isSubmitted) {
                    this.mostrarResultados();
                    return;
                }

                this.evaluarRespuestas();
                this.mostrarResultados();
                this.isSubmitted = true;
                this.saveProgress();
            },

            /**
             * Manejar cambio de respuesta
             */
            onAnswerChange: function(event) {
                const radio = event.target;
                const questionName = radio.name;
                
                // Guardar respuesta
                this.respuestasUsuario[questionName] = radio.value;
                this.saveProgress();
            },

            /**
             * Evaluar todas las respuestas
             */
            evaluarRespuestas: function() {
                let score = 0;
                const totalQuestions = Object.keys(this.respuestasCorrectas).length;

                // Evaluar cada pregunta
                for (const [questionId, correctAnswer] of Object.entries(this.respuestasCorrectas)) {
                    const userAnswer = this.respuestasUsuario[questionId];
                    const questionNumber = questionId.replace('q', '');
                    
                    this.mostrarFeedback(questionNumber, userAnswer, correctAnswer);
                    
                    if (userAnswer === correctAnswer) {
                        score++;
                    }
                }

                this.calcularResultadoFinal(score, totalQuestions);
            },

            /**
             * Mostrar feedback por pregunta
             */
            mostrarFeedback: function(questionNumber, userAnswer, correctAnswer) {
                const feedbackEl = document.getElementById(`feedback${questionNumber}`);
                if (!feedbackEl) return;

                // Limpiar feedback anterior
                feedbackEl.className = 'feedback';
                feedbackEl.innerHTML = '';

                if (!userAnswer) {
                    feedbackEl.textContent = 'No respondida ⚠️';
                    feedbackEl.classList.add('warning');
                    return;
                }

                if (userAnswer === correctAnswer) {
                    feedbackEl.innerHTML = '✅ <strong>Correcto!</strong>';
                    feedbackEl.classList.add('correct');
                } else {
                    feedbackEl.innerHTML = `❌ <strong>Incorrecto.</strong> La respuesta correcta es ${this.getAnswerText(correctAnswer, questionNumber)}`;
                    feedbackEl.classList.add('incorrect');
                }
            },

            /**
             * Obtener texto de la respuesta
             */
            getAnswerText: function(answerKey, questionNumber) {
                const answerTexts = {
                    'A': this.getAnswerDescription('A', questionNumber),
                    'B': this.getAnswerDescription('B', questionNumber),
                    'C': this.getAnswerDescription('C', questionNumber)
                };
                return answerTexts[answerKey] || answerKey;
            },

            /**
             * Obtener descripción de la respuesta
             */
            getAnswerDescription: function(answer, questionNumber) {
                const descriptions = {
                    '1': { 'A': 'Lineal', 'B': 'Cuadrática', 'C': 'Cúbica' },
                    '2': { 'A': 'y = x + 2', 'B': 'y = x² - 1', 'C': 'y = 2x' },
                    '3': { 'A': 'Racional', 'B': 'Cúbica', 'C': 'Exponencial' },
                    '4': { 'A': 'y = 1/x', 'B': 'y = √x', 'C': 'y = x²' },
                    '5': { 'A': 'Raíz cuadrada', 'B': 'Lineal', 'C': 'Cuadrática' },
                    '6': { 'A': 'y = -x + 2', 'B': 'y = x + 2', 'C': 'y = 2x' },
                    '7': { 'A': 'Forma de "V"', 'B': 'Forma de parábola', 'C': 'Línea recta' },
                    '8': { 'A': 'y = -x² + 4', 'B': 'y = x² + 4', 'C': 'y = x² - 4' },
                    '9': { 'A': 'Exponencial', 'B': 'Logarítmica', 'C': 'Lineal' },
                    '10': { 'A': 'y = (x-1)/(x+2)', 'B': 'y = x²', 'C': 'y = √x' }
                };
                return descriptions[questionNumber][answer] || answer;
            },

            /**
             * Calcular resultado final
             */
            calcularResultadoFinal: function(score, total) {
                const resultsDiv = document.getElementById('results');
                if (!resultsDiv) return;

                const percentage = (score / total) * 100;
                
                let message, emoji, colorClass;
                
                if (percentage >= 90) {
                    message = '¡Excelente! Dominas perfectamente las gráficas de funciones 🎉';
                    emoji = '🏆';
                    colorClass = 'excellent';
                } else if (percentage >= 70) {
                    message = '¡Buen trabajo! Tienes un buen entendimiento de las gráficas 👍';
                    emoji = '⭐';
                    colorClass = 'good';
                } else if (percentage >= 50) {
                    message = '¡Bien hecho! Sigue practicando para mejorar 💪';
                    emoji = '📚';
                    colorClass = 'average';
                } else {
                    message = 'Sigue estudiando y practicando. ¡Tú puedes! 📖';
                    emoji = '🎯';
                    colorClass = 'needs-improvement';
                }

                resultsDiv.innerHTML = `
                    <div class="evaluation-results ${colorClass}">
                        <h3>Resultado de la Evaluación</h3>
                        <div class="evaluation-score">${score}/${total}</div>
                        <div class="evaluation-percentage">${percentage.toFixed(0)}%</div>
                        <p>${message} ${emoji}</p>
                        <div class="evaluation-progress">
                            <div class="evaluation-progress-bar" style="width: ${percentage}%"></div>
                        </div>
                        <p class="evaluation-feedback">${this.getDetailedFeedback(percentage)}</p>
                    </div>
                `;
                
                resultsDiv.style.display = 'block';
                
                // Animación
                setTimeout(() => {
                    resultsDiv.classList.add('evaluation-correct');
                }, 100);
            },

            /**
             * Obtener feedback detallado
             */
            getDetailedFeedback: function(percentage) {
                if (percentage >= 90) {
                    return 'Has demostrado un excelente entendimiento de los diferentes tipos de funciones y sus gráficas.';
                } else if (percentage >= 70) {
                    return 'Tienes un buen conocimiento base. Revisa los conceptos de funciones racionales y exponenciales.';
                } else if (percentage >= 50) {
                    return 'Recomendamos repasar las características de las funciones cuadráticas, cúbicas y racionales.';
                } else {
                    return 'Te sugerimos revisar la teoría sobre los diferentes tipos de funciones y practicar más con los ejemplos.';
                }
            },

            /**
             * Mostrar resultados
             */
            mostrarResultados: function() {
                const resultsDiv = document.getElementById('results');
                if (resultsDiv && resultsDiv.style.display !== 'block') {
                    resultsDiv.style.display = 'block';
                }
            },

            /**
             * Reiniciar formulario
             */
            resetForm: function() {
                const form = document.getElementById('evaluationForm');
                if (form) {
                    form.reset();
                }

                // Limpiar feedback
                document.querySelectorAll('.feedback').forEach(el => {
                    el.innerHTML = '';
                    el.className = 'feedback';
                });

                // Ocultar resultados
                const resultsDiv = document.getElementById('results');
                if (resultsDiv) {
                    resultsDiv.style.display = 'none';
                    resultsDiv.innerHTML = '';
                }

                // Resetear estado
                this.respuestasUsuario = {};
                this.isSubmitted = false;
                
                // Limpiar progreso
                localStorage.removeItem('evaluacion-progress');
            },

            /**
             * Cargar progreso
             */
            loadProgress: function() {
                const saved = localStorage.getItem('evaluacion-progress');
                if (saved) {
                    const progress = JSON.parse(saved);
                    this.respuestasUsuario = progress.respuestasUsuario || {};
                    this.isSubmitted = progress.isSubmitted || false;
                    
                    // Restaurar respuestas
                    this.restoreAnswers();
                }
            },

            /**
             * Guardar progreso
             */
            saveProgress: function() {
                const progress = {
                    respuestasUsuario: this.respuestasUsuario,
                    isSubmitted: this.isSubmitted,
                    timestamp: new Date().toISOString()
                };
                
                localStorage.setItem('evaluacion-progress', JSON.stringify(progress));
            },

            /**
             * Restaurar respuestas desde progreso
             */
            restoreAnswers: function() {
                for (const [questionName, answer] of Object.entries(this.respuestasUsuario)) {
                    const radio = document.querySelector(`input[name="${questionName}"][value="${answer}"]`);
                    if (radio) {
                        radio.checked = true;
                    }
                }
            },

            /**
             * Actualizar UI de progreso
             */
            updateProgressUI: function() {
                const answeredCount = Object.keys(this.respuestasUsuario).length;
                const totalQuestions = Object.keys(this.respuestasCorrectas).length;
                
                // Puedes mostrar un indicador de progreso si quieres
                console.log(`Progreso: ${answeredCount}/${totalQuestions} preguntas respondidas`);
            }
        };

        // Inicializar cuando el DOM esté listo
        document.addEventListener('DOMContentLoaded', function() {
            // Inicializar navegación
            NavigationManager.init();
            
            // Inicializar evaluación
            EvaluacionManager.init();
        });
    </script>
</body>
</html>